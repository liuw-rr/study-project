<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <title>今天是4月21日-js页面</title>
    <base target="_blank"/>
    <link rel="stylesheet" href="">
    <script></script>
    <style></style>
</head>

<body>
    <div>暂时看console吧</div>
    <button type= "button" onclick="ajaxRequest()">ajax请求按钮</button>
</body>

<script src="lr.js"></script>
<script>
    var person = {
        // firstName:"Bill",
        // lastName: "Gates",
        fullName: function(canshuOne, canshuTwo) {
            return this.firstName + " " + this.lastName + " " + canshuOne + " " + canshuTwo
        }
    }
    var person1 = {
        firstName: "person1对象用call方法",
        lastName: "调用所有者对象person的方法"
    }
    var person2 = {
        firstName: "这个是用person2对象",
        lastName: "调用person方法"
    }
    var person3 = {
        firstName: "这个是用person3对象",
        lastName: "调用person方法"
    }
    // console.log(person.fullName())这个是调用person
    console.log(person.fullName.call(person1,"参数1","参数2"))
    console.log(person.fullName.call(person2))
    console.log(person.fullName.apply(person3,["数组形式的参数1", "数组形式的参数2"]))
    console.log(person)
    var a = 1;
    var b = "1";
    var c = "a";
    a++;
    b++;
    c++
    console.log(typeof a)
    console.log(typeof b)
    console.log(c)
    console.log( a == b );
    // try-catch语句
    try {
        consle.log(0);
        // new eval();
    } catch (error) {
        // message属性-所有浏览器都支持-跨浏览器编程最好只用message属性
        console.log(error.message);
        console.log(error.name);
        console.log(`判断类型：${error instanceof ReferenceError}`);
    }finally{
        console.log("finally子句总会执行");
    }

    function ajaxRequest() {
        var xhr = new XMLHttpRequest();

        console.log(`开始执行ajax，readyState is ` + xhr.readyState);

        xhr.onreadystatechange = function() {

            console.log("请求状态变化，readyState is " + xhr.readyState)
            // console.log(xhr)

            if(xhr.readyState == 4) {
                if((xhr.status >= 200 && xhr.status < 300)|| xhr.status ==304){
                    console.log(xhr.responseText);
                    // 跨域XHR对象的限制：
                    // 调用getAllResponseHeader()方法总会返回空字符串
                    // 详见红宝书-21.4.2
                    console.log(xhr.getResponseHeader("MyHeader"));
                    console.log(xhr.getAllResponseHeaders());
                } 
            } else {
                console.log(`Request was unsuccessful: &{xhr.status}`)
            }
        }
      
        console.log(`判断状态变化后，open方法未执行，readyState is ${xhr.readyState}`);
        xhr.open("get","http://101.201.254.58:8910/test/info/1",true);
        console.log(`open已执行，send未执行，readyState is ${xhr.readyState}`);
        // 跨域XHR对象的限制：
        // 不能使用setRequestHeader()设置自定义头部
        // 详见红宝书-21.4.2
        xhr.setRequestHeader("MyHeader","MyValue");
        xhr.send(null);
        console.log(`open、send已执行，readyState is ${xhr.readyState}`);
        // 取消异步请求
        // xhr.abort();
        console.log(`代码结束位置，readyState is ` + xhr.readyState);
    }
    
</script>

</html>